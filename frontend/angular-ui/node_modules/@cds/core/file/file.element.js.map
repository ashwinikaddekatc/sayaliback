{"version":3,"file":"file.element.js","sourceRoot":"","sources":["../../../src/file/file.element.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016-2021 VMware, Inc. All Rights Reserved.\n * This software is released under MIT license.\n * The full license information can be found in LICENSE in the root directory of this project.\n */\n\nimport { html, internalProperty } from 'lit-element';\nimport { i18n, I18nService } from '@cds/core/internal';\nimport { CdsControl } from '@cds/core/forms';\nimport { ClarityIcons } from '@cds/core/icon/icon.service.js';\nimport { folderIcon } from '@cds/core/icon/shapes/folder.js';\nimport { timesIcon } from '@cds/core/icon/shapes/times.js';\nimport { styles } from './file.element.css.js';\n\n/**\n * Time Input\n *\n * ```typescript\n * import '@cds/core/file/register.js';\n * ```\n *\n * ```html\n * <cds-file>\n *   <label>file</label>\n *   <input type=\"file\" />\n * </cds-file>\n * ```\n *\n * @element cds-file\n * @slot - For projecting file input and label\n */\nexport class CdsFile extends CdsControl {\n  @i18n() i18n = I18nService.keys.file;\n\n  @internalProperty() private buttonLabel = this.i18n.browse;\n\n  @internalProperty() protected fixedControlWidth = true;\n\n  @internalProperty() protected supportsPrefixSuffixActions = false;\n\n  static get styles() {\n    return [...super.styles, styles];\n  }\n\n  protected get inputTemplate() {\n    return html`\n      <div>\n        <cds-button size=\"sm\" action=\"outline\" @click=\"${() => this.label.click()}\" ?disabled=${this.disabled}>\n          <cds-icon shape=\"folder\" aria-hidden=\"true\"></cds-icon>\n          ${this.buttonLabel}\n        </cds-button>\n        ${this.clearFilesControlTemplate}\n      </div>\n    `;\n  }\n\n  protected get clearFilesControlTemplate() {\n    return this.inputControl.files?.length && !this.disabled\n      ? html` <cds-control-action @click=\"${() => this.clearFiles()}\" aria-label=\"${this.i18n.removeFile}\">\n          <cds-icon shape=\"times\"></cds-icon>\n        </cds-control-action>`\n      : html``;\n  }\n\n  firstUpdated(props: Map<string, any>) {\n    super.firstUpdated(props);\n    (this.inputControl as Element).addEventListener('change', e => {\n      // NOTE: have to distinguish here being user-caused events and programmatic\n      // events (e.isTrusted true/false) so that we don't fire a change event loop\n      if (e.isTrusted) {\n        this.updateLabelAndFocus((e.target as any).files);\n      }\n    });\n  }\n\n  /** @private */\n  clearFiles(fireEvent = true) {\n    this.buttonLabel = this.i18n.browse;\n    this.inputControl.value = '';\n\n    // when input is reset like this it isn't registering an onchange event\n    // NOTE: tsc + karma is complaining about dispatchEvent being a method on inputControl\n    if (fireEvent && this.inputControl.dispatchEvent) {\n      (this.inputControl as Element).dispatchEvent(new Event('change'));\n    }\n\n    const browseButton = this.shadowRoot?.querySelector('cds-button');\n    if (browseButton) {\n      browseButton.focus();\n    }\n  }\n\n  /** @private */\n  updateLabelAndFocus(files?: FileList) {\n    if (files && files.length) {\n      this.buttonLabel = files.length > 1 ? `${files.length} ${this.i18n.files}` : files[0].name;\n    } else {\n      this.clearFiles(false);\n    }\n  }\n\n  constructor() {\n    super();\n    ClarityIcons.addIcons(folderIcon, timesIcon);\n  }\n}\n"]}