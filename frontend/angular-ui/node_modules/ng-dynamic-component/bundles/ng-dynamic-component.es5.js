import { InjectionToken, Directive, Host, Inject, Injector, Input, KeyValueDiffers, Optional, Renderer2, Component, ComponentFactoryResolver, EventEmitter, Output, ViewContainerRef, SimpleChange, ANALYZE_FOR_ENTRY_COMPONENTS, NgModule } from '@angular/core';
import { NgComponentOutlet, CommonModule } from '@angular/common';
import { takeUntil } from 'rxjs/operators';
import { Subject } from 'rxjs';
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';
var /** @type {?} */ COMPONENT_INJECTOR = new InjectionToken('ComponentInjector');
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var ComponentOutletInjectorDirective = /** @class */ (function () {
    /**
     * @param {?} componentOutlet
     */
    function ComponentOutletInjectorDirective(componentOutlet) {
        this.componentOutlet = componentOutlet;
    }
    Object.defineProperty(ComponentOutletInjectorDirective.prototype, "componentRef", {
        /**
         * @return {?}
         */
        get: function () {
            return ((this.componentOutlet))._componentRef;
        },
        enumerable: true,
        configurable: true
    });
ComponentOutletInjectorDirective.ɵfac = function ComponentOutletInjectorDirective_Factory(t) { return new (t || ComponentOutletInjectorDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.NgComponentOutlet, 1)); };
ComponentOutletInjectorDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: ComponentOutletInjectorDirective, selectors: [["", "ngComponentOutlet", ""]], exportAs: ["ndcComponentOutletInjector"] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ComponentOutletInjectorDirective, [{
        type: Directive,
        args: [{
                selector: '[ngComponentOutlet]',
                exportAs: 'ndcComponentOutletInjector'
            }]
    }], function () { return [{ type: ɵngcc1.NgComponentOutlet, decorators: [{
                type: Host
            }] }]; }, null); })();
    return ComponentOutletInjectorDirective;
}());
/** @nocollapse */
ComponentOutletInjectorDirective.ctorParameters = function () { return [
    { type: NgComponentOutlet, decorators: [{ type: Host },] },
]; };
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var DynamicAttributesDirective = /** @class */ (function () {
    /**
     * @param {?} renderer
     * @param {?} differs
     * @param {?} injector
     * @param {?} componentInjectorType
     * @param {?} componentOutletInjector
     */
    function DynamicAttributesDirective(renderer, differs, injector, componentInjectorType, componentOutletInjector) {
        this.renderer = renderer;
        this.differs = differs;
        this.injector = injector;
        this.componentInjectorType = componentInjectorType;
        this.componentOutletInjector = componentOutletInjector;
        this._attrsDiffer = this.differs.find({}).create();
        this._componentInjector = this.injector.get(this.componentInjectorType, null);
    }
    Object.defineProperty(DynamicAttributesDirective.prototype, "_attributes", {
        /**
         * @return {?}
         */
        get: function () {
            return (this.ndcDynamicAttributes || this.ngComponentOutletNdcDynamicAttributes);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicAttributesDirective.prototype, "_compInjector", {
        /**
         * @return {?}
         */
        get: function () {
            return this.componentOutletInjector || this._componentInjector;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicAttributesDirective.prototype, "_nativeElement", {
        /**
         * @return {?}
         */
        get: function () {
            return this._compInjector.componentRef.location.nativeElement;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicAttributesDirective.prototype, "_compType", {
        /**
         * @return {?}
         */
        get: function () {
            return this._compInjector.componentRef.componentType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicAttributesDirective.prototype, "_isCompChanged", {
        /**
         * @return {?}
         */
        get: function () {
            if (this._lastCompType !== this._compType) {
                this._lastCompType = this._compType;
                return true;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DynamicAttributesDirective.prototype.ngDoCheck = function () {
        var /** @type {?} */ isCompChanged = this._isCompChanged;
        var /** @type {?} */ changes = this._attrsDiffer.diff(this._attributes);
        if (changes) {
            this._lastAttrActions = this._changesToAttrActions(changes);
        }
        if (changes || (isCompChanged && this._lastAttrActions)) {
            this._updateAttributes(this._lastAttrActions);
        }
    };
    /**
     * @param {?} name
     * @param {?} value
     * @param {?=} namespace
     * @return {?}
     */
    DynamicAttributesDirective.prototype.setAttribute = function (name, value, namespace) {
        this.renderer.setAttribute(this._nativeElement, name, value, namespace);
    };
    /**
     * @param {?} name
     * @param {?=} namespace
     * @return {?}
     */
    DynamicAttributesDirective.prototype.removeAttribute = function (name, namespace) {
        this.renderer.removeAttribute(this._nativeElement, name, namespace);
    };
    /**
     * @param {?} actions
     * @return {?}
     */
    DynamicAttributesDirective.prototype._updateAttributes = function (actions) {
        var _this = this;
        Object.keys(actions.set).forEach(function (key) { return _this.setAttribute(key, actions.set[key]); });
        actions.remove.forEach(function (key) { return _this.removeAttribute(key); });
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicAttributesDirective.prototype._changesToAttrActions = function (changes) {
        var /** @type {?} */ attrActions = {
            set: {},
            remove: [],
        };
        changes.forEachAddedItem(function (r) { return (attrActions.set[r.key] = r.currentValue); });
        changes.forEachChangedItem(function (r) { return (attrActions.set[r.key] = r.currentValue); });
        changes.forEachRemovedItem(function (r) { return attrActions.remove.push(r.key); });
        return attrActions;
    };
DynamicAttributesDirective.ɵfac = function DynamicAttributesDirective_Factory(t) { return new (t || DynamicAttributesDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.KeyValueDiffers), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Injector), ɵngcc0.ɵɵdirectiveInject(COMPONENT_INJECTOR), ɵngcc0.ɵɵdirectiveInject(ComponentOutletInjectorDirective, 9)); };
DynamicAttributesDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DynamicAttributesDirective, selectors: [["", "ndcDynamicAttributes", ""], ["", "ngComponentOutletNdcDynamicAttributes", ""]], inputs: { ndcDynamicAttributes: "ndcDynamicAttributes", ngComponentOutletNdcDynamicAttributes: "ngComponentOutletNdcDynamicAttributes" }, exportAs: ["ndcDynamicAttributes"] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DynamicAttributesDirective, [{
        type: Directive,
        args: [{
                selector: '[ndcDynamicAttributes],[ngComponentOutletNdcDynamicAttributes]',
                exportAs: 'ndcDynamicAttributes'
            }]
    }], function () { return [{ type: ɵngcc0.Renderer2 }, { type: ɵngcc0.KeyValueDiffers }, { type: ɵngcc0.Injector }, { type: undefined, decorators: [{
                type: Inject,
                args: [COMPONENT_INJECTOR]
            }] }, { type: ComponentOutletInjectorDirective, decorators: [{
                type: Optional
            }, {
                type: Host
            }] }]; }, { ndcDynamicAttributes: [{
            type: Input
        }], ngComponentOutletNdcDynamicAttributes: [{
            type: Input
        }] }); })();
    return DynamicAttributesDirective;
}());
/** @nocollapse */
DynamicAttributesDirective.ctorParameters = function () { return [
    { type: Renderer2, },
    { type: KeyValueDiffers, },
    { type: Injector, },
    { type: undefined, decorators: [{ type: Inject, args: [COMPONENT_INJECTOR,] },] },
    { type: ComponentOutletInjectorDirective, decorators: [{ type: Optional }, { type: Host },] },
]; };
DynamicAttributesDirective.propDecorators = {
    "ndcDynamicAttributes": [{ type: Input },],
    "ngComponentOutletNdcDynamicAttributes": [{ type: Input },],
};
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var DynamicComponent = /** @class */ (function () {
    /**
     * @param {?} _vcr
     * @param {?} _cfr
     */
    function DynamicComponent(_vcr, _cfr) {
        this._vcr = _vcr;
        this._cfr = _cfr;
        this.ndcDynamicCreated = new EventEmitter();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicComponent.prototype.ngOnChanges = function (changes) {
        if (changes['ndcDynamicComponent']) {
            this.createDynamicComponent();
        }
    };
    /**
     * @return {?}
     */
    DynamicComponent.prototype.createDynamicComponent = function () {
        this._vcr.clear();
        this.componentRef = null;
        if (this.ndcDynamicComponent) {
            this.componentRef = this._vcr.createComponent(this._cfr.resolveComponentFactory(this.ndcDynamicComponent), 0, this._resolveInjector(), this.ndcDynamicContent);
            this.ndcDynamicCreated.emit(this.componentRef);
        }
    };
    /**
     * @return {?}
     */
    DynamicComponent.prototype._resolveInjector = function () {
        var /** @type {?} */ injector = this.ndcDynamicInjector || this._vcr.parentInjector;
        if (this.ndcDynamicProviders) {
            injector = Injector.create({
                providers: this.ndcDynamicProviders,
                parent: injector,
            });
        }
        return injector;
    };
DynamicComponent.ɵfac = function DynamicComponent_Factory(t) { return new (t || DynamicComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ViewContainerRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ComponentFactoryResolver)); };
DynamicComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: DynamicComponent, selectors: [["ndc-dynamic"]], inputs: { ndcDynamicComponent: "ndcDynamicComponent", ndcDynamicInjector: "ndcDynamicInjector", ndcDynamicProviders: "ndcDynamicProviders", ndcDynamicContent: "ndcDynamicContent" }, outputs: { ndcDynamicCreated: "ndcDynamicCreated" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 0, vars: 0, template: function DynamicComponent_Template(rf, ctx) { }, encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DynamicComponent, [{
        type: Component,
        args: [{
                selector: 'ndc-dynamic',
                template: ''
            }]
    }], function () { return [{ type: ɵngcc0.ViewContainerRef }, { type: ɵngcc0.ComponentFactoryResolver }]; }, { ndcDynamicCreated: [{
            type: Output
        }], ndcDynamicComponent: [{
            type: Input
        }], ndcDynamicInjector: [{
            type: Input
        }], ndcDynamicProviders: [{
            type: Input
        }], ndcDynamicContent: [{
            type: Input
        }] }); })();
    return DynamicComponent;
}());
/** @nocollapse */
DynamicComponent.ctorParameters = function () { return [
    { type: ViewContainerRef, },
    { type: ComponentFactoryResolver, },
]; };
DynamicComponent.propDecorators = {
    "ndcDynamicComponent": [{ type: Input },],
    "ndcDynamicInjector": [{ type: Input },],
    "ndcDynamicProviders": [{ type: Input },],
    "ndcDynamicContent": [{ type: Input },],
    "ndcDynamicCreated": [{ type: Output },],
};
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @param {?} val
 * @return {?}
 */
function createNewChange(val) {
    return new SimpleChange(undefined, val, true);
}
/**
 * @param {?} record
 * @param {?=} isFirstChange
 * @return {?}
 */
function recordToChange(record, isFirstChange) {
    if (isFirstChange === void 0) { isFirstChange = false; }
    return isFirstChange
        ? createNewChange(record.currentValue)
        : new SimpleChange(record.previousValue, record.currentValue, false);
}
/**
 * @param {?} isFirstChanges
 * @param {?} setter
 * @return {?}
 */
function setChangeFromRecord(isFirstChanges, setter) {
    return function (record) { return setter(record, recordToChange(record, isFirstChanges)); };
}
/**
 * @param {?} isFirstChanges
 * @return {?}
 */
function getChangesRecords(isFirstChanges) {
    return function (changes) { return setChangeFromRecord(isFirstChanges, function (record, change) { return changes[record.key] = change; }); };
}
/**
 * @param {?} isFirstChanges
 * @return {?}
 */
function getNewChangesRecords(isFirstChanges) {
    return function (changes) { return setChangeFromRecord(isFirstChanges, function (record, change) {
        if (!changes[record.key]) {
            changes[record.key] = change;
        }
    }); };
}
var /** @type {?} */ defaultOpts = {
    isFirstChanges: false,
    onlyNewChanges: false,
};
/**
 * @param {?=} opts
 * @return {?}
 */
function changesFromRecord(opts) {
    if (opts === void 0) { opts = defaultOpts; }
    return opts.onlyNewChanges
        ? getNewChangesRecords(opts.isFirstChanges)
        : getChangesRecords(opts.isFirstChanges);
}
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var /** @type {?} */ recordToChanges = changesFromRecord({ isFirstChanges: true });
var /** @type {?} */ recordToNewChanges = changesFromRecord({ onlyNewChanges: true });
var DynamicDirective = /** @class */ (function () {
    /**
     * @param {?} _differs
     * @param {?} _injector
     * @param {?} _cfr
     * @param {?} _componentInjectorType
     * @param {?} _componentOutletInjector
     */
    function DynamicDirective(_differs, _injector, _cfr, _componentInjectorType, _componentOutletInjector) {
        this._differs = _differs;
        this._injector = _injector;
        this._cfr = _cfr;
        this._componentInjectorType = _componentInjectorType;
        this._componentOutletInjector = _componentOutletInjector;
        this._componentInjector = this._injector.get(this._componentInjectorType, null);
        this._lastComponentInst = this._componentInjector;
        this._inputsDiffer = this._differs.find({}).create();
        this._compFactory = null;
        this._outputsShouldDisconnect$ = new Subject();
    }
    Object.defineProperty(DynamicDirective.prototype, "_inputs", {
        /**
         * @return {?}
         */
        get: function () {
            return this.ndcDynamicInputs || this.ngComponentOutletNdcDynamicInputs;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicDirective.prototype, "_outputs", {
        /**
         * @return {?}
         */
        get: function () {
            return this.ndcDynamicOutputs || this.ngComponentOutletNdcDynamicOutputs;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicDirective.prototype, "_compInjector", {
        /**
         * @return {?}
         */
        get: function () {
            return this._componentOutletInjector || this._componentInjector;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicDirective.prototype, "_compRef", {
        /**
         * @return {?}
         */
        get: function () {
            return this._compInjector.componentRef;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicDirective.prototype, "_componentInst", {
        /**
         * @return {?}
         */
        get: function () {
            return this._compRef.instance;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicDirective.prototype, "_componentInstChanged", {
        /**
         * @return {?}
         */
        get: function () {
            if (this._lastComponentInst !== this._componentInst) {
                this._lastComponentInst = this._componentInst;
                return true;
            }
            else {
                return false;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicDirective.prototype.ngOnChanges = function (changes) {
        var /** @type {?} */ compChanged = this._componentInstChanged;
        if (compChanged || this._inputsChanged(changes)) {
            var /** @type {?} */ inputsChanges = this._getInputsChanges(this._inputs);
            if (inputsChanges) {
                this._updateInputChanges(inputsChanges);
            }
            this.updateInputs(compChanged || !this._lastInputChanges);
        }
        if (compChanged || this._outputsChanged(changes)) {
            this.bindOutputs();
        }
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype.ngDoCheck = function () {
        if (this._componentInstChanged) {
            this.updateInputs(true);
            this.bindOutputs();
            return;
        }
        var /** @type {?} */ inputs = this._inputs;
        if (!inputs) {
            return;
        }
        var /** @type {?} */ inputsChanges = this._getInputsChanges(this._inputs);
        if (inputsChanges) {
            var /** @type {?} */ isNotFirstChange = !!this._lastInputChanges;
            this._updateInputChanges(inputsChanges);
            if (isNotFirstChange) {
                this.updateInputs();
            }
        }
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype.ngOnDestroy = function () {
        this._disconnectOutputs();
    };
    /**
     * @param {?=} isFirstChange
     * @return {?}
     */
    DynamicDirective.prototype.updateInputs = function (isFirstChange) {
        if (isFirstChange === void 0) { isFirstChange = false; }
        if (isFirstChange) {
            this._updateCompFactory();
        }
        var /** @type {?} */ compInst = this._componentInst;
        var /** @type {?} */ inputs = this._inputs;
        if (!inputs || !compInst) {
            return;
        }
        inputs = this._resolveInputs(inputs);
        Object.keys(inputs).forEach(function (p) { return (compInst[p] = inputs[p]); });
        this.notifyOnInputChanges(this._lastInputChanges, isFirstChange);
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype.bindOutputs = function () {
        var _this = this;
        this._disconnectOutputs();
        var /** @type {?} */ compInst = this._componentInst;
        var /** @type {?} */ outputs = this._outputs;
        if (!outputs || !compInst) {
            return;
        }
        outputs = this._resolveOutputs(outputs);
        Object.keys(outputs)
            .filter(function (p) { return compInst[p]; })
            .forEach(function (p) { return compInst[p]
            .pipe(takeUntil(_this._outputsShouldDisconnect$))
            .subscribe(outputs[p]); });
    };
    /**
     * @param {?=} changes
     * @param {?=} forceFirstChanges
     * @return {?}
     */
    DynamicDirective.prototype.notifyOnInputChanges = function (changes, forceFirstChanges) {
        if (changes === void 0) { changes = {}; }
        // Exit early if component not interested to receive changes
        if (!this._componentInst.ngOnChanges) {
            return;
        }
        if (forceFirstChanges) {
            changes = this._collectFirstChanges();
        }
        this._componentInst.ngOnChanges(changes);
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype._disconnectOutputs = function () {
        this._outputsShouldDisconnect$.next();
    };
    /**
     * @param {?} inputs
     * @return {?}
     */
    DynamicDirective.prototype._getInputsChanges = function (inputs) {
        return this._inputsDiffer.diff(this._inputs);
    };
    /**
     * @param {?} differ
     * @return {?}
     */
    DynamicDirective.prototype._updateInputChanges = function (differ) {
        this._lastInputChanges = this._collectChangesFromDiffer(differ);
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype._collectFirstChanges = function () {
        var /** @type {?} */ changes = ({});
        var /** @type {?} */ inputs = this._inputs;
        Object.keys(inputs).forEach(function (prop) { return (changes[prop] = createNewChange(inputs[prop])); });
        return this._resolveChanges(changes);
    };
    /**
     * @param {?} differ
     * @return {?}
     */
    DynamicDirective.prototype._collectChangesFromDiffer = function (differ) {
        var /** @type {?} */ changes = ({});
        differ.forEachAddedItem(recordToChanges(changes));
        differ.forEachItem(recordToNewChanges(changes));
        return this._resolveChanges(changes);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicDirective.prototype._inputsChanged = function (changes) {
        return ('ngComponentOutletNdcDynamicInputs' in changes ||
            'ndcDynamicInputs' in changes);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicDirective.prototype._outputsChanged = function (changes) {
        return ('ngComponentOutletNdcDynamicOutputs' in changes ||
            'ndcDynamicOutputs' in changes);
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype._resolveCompFactory = function () {
        try {
            try {
                return this._cfr.resolveComponentFactory(this._compRef.componentType);
            }
            catch (e) {
                // Fallback if componentType does not exist (happens on NgComponentOutlet)
                return this._cfr.resolveComponentFactory(this._compRef.instance.constructor);
            }
        }
        catch (e) {
            // Factory not available - bailout
            return null;
        }
    };
    /**
     * @return {?}
     */
    DynamicDirective.prototype._updateCompFactory = function () {
        this._compFactory = this._resolveCompFactory();
    };
    /**
     * @param {?} inputs
     * @return {?}
     */
    DynamicDirective.prototype._resolveInputs = function (inputs) {
        if (!this._compFactory) {
            return inputs;
        }
        return this._remapIO(inputs, this._compFactory.inputs);
    };
    /**
     * @param {?} outputs
     * @return {?}
     */
    DynamicDirective.prototype._resolveOutputs = function (outputs) {
        if (!this._compFactory) {
            return outputs;
        }
        return this._remapIO(outputs, this._compFactory.outputs);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicDirective.prototype._resolveChanges = function (changes) {
        if (!this._compFactory) {
            return changes;
        }
        return this._remapIO(changes, this._compFactory.inputs);
    };
    /**
     * @param {?} io
     * @param {?} mapping
     * @return {?}
     */
    DynamicDirective.prototype._remapIO = function (io, mapping) {
        var _this = this;
        var /** @type {?} */ newIO = {};
        Object.keys(io).forEach(function (key) {
            var /** @type {?} */ newKey = _this._findPropByTplInMapping(key, mapping) || key;
            newIO[newKey] = io[key];
        });
        return newIO;
    };
    /**
     * @param {?} tplName
     * @param {?} mapping
     * @return {?}
     */
    DynamicDirective.prototype._findPropByTplInMapping = function (tplName, mapping) {
        for (var _i = 0, mapping_1 = mapping; _i < mapping_1.length; _i++) {
            var map = mapping_1[_i];
            if (map.templateName === tplName) {
                return map.propName;
            }
        }
        return null;
    };
DynamicDirective.ɵfac = function DynamicDirective_Factory(t) { return new (t || DynamicDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.KeyValueDiffers), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Injector), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ComponentFactoryResolver), ɵngcc0.ɵɵdirectiveInject(COMPONENT_INJECTOR), ɵngcc0.ɵɵdirectiveInject(ComponentOutletInjectorDirective, 9)); };
DynamicDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DynamicDirective, selectors: [["", "ndcDynamicInputs", ""], ["", "ndcDynamicOutputs", ""], ["", "ngComponentOutletNdcDynamicInputs", ""], ["", "ngComponentOutletNdcDynamicOutputs", ""]], inputs: { ndcDynamicInputs: "ndcDynamicInputs", ngComponentOutletNdcDynamicInputs: "ngComponentOutletNdcDynamicInputs", ndcDynamicOutputs: "ndcDynamicOutputs", ngComponentOutletNdcDynamicOutputs: "ngComponentOutletNdcDynamicOutputs" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DynamicDirective, [{
        type: Directive,
        args: [{
                selector: '[ndcDynamicInputs],[ndcDynamicOutputs],[ngComponentOutletNdcDynamicInputs],[ngComponentOutletNdcDynamicOutputs]'
            }]
    }], function () { return [{ type: ɵngcc0.KeyValueDiffers }, { type: ɵngcc0.Injector }, { type: ɵngcc0.ComponentFactoryResolver }, { type: undefined, decorators: [{
                type: Inject,
                args: [COMPONENT_INJECTOR]
            }] }, { type: ComponentOutletInjectorDirective, decorators: [{
                type: Host
            }, {
                type: Optional
            }] }]; }, { ndcDynamicInputs: [{
            type: Input
        }], ngComponentOutletNdcDynamicInputs: [{
            type: Input
        }], ndcDynamicOutputs: [{
            type: Input
        }], ngComponentOutletNdcDynamicOutputs: [{
            type: Input
        }] }); })();
    return DynamicDirective;
}());
/** @nocollapse */
DynamicDirective.ctorParameters = function () { return [
    { type: KeyValueDiffers, },
    { type: Injector, },
    { type: ComponentFactoryResolver, },
    { type: undefined, decorators: [{ type: Inject, args: [COMPONENT_INJECTOR,] },] },
    { type: ComponentOutletInjectorDirective, decorators: [{ type: Host }, { type: Optional },] },
]; };
DynamicDirective.propDecorators = {
    "ndcDynamicInputs": [{ type: Input },],
    "ngComponentOutletNdcDynamicInputs": [{ type: Input },],
    "ndcDynamicOutputs": [{ type: Input },],
    "ngComponentOutletNdcDynamicOutputs": [{ type: Input },],
};
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var DynamicModule = /** @class */ (function () {
    function DynamicModule() {
    }
    /**
     * @param {?} components
     * @param {?=} componentInjector
     * @return {?}
     */
    DynamicModule.withComponents = function (components, componentInjector) {
        if (componentInjector === void 0) { componentInjector = DynamicComponent; }
        return {
            ngModule: DynamicModule,
            providers: [
                {
                    provide: ANALYZE_FOR_ENTRY_COMPONENTS,
                    useValue: components,
                    multi: true,
                },
                { provide: COMPONENT_INJECTOR, useValue: componentInjector },
            ],
        };
    };
DynamicModule.ɵfac = function DynamicModule_Factory(t) { return new (t || DynamicModule)(); };
DynamicModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: DynamicModule });
DynamicModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ imports: [[CommonModule]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(DynamicModule, { declarations: function () { return [DynamicComponent, DynamicDirective, ComponentOutletInjectorDirective, DynamicAttributesDirective]; }, imports: function () { return [CommonModule]; }, exports: function () { return [DynamicComponent, DynamicDirective, ComponentOutletInjectorDirective, DynamicAttributesDirective]; } }); })();
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DynamicModule, [{
        type: NgModule,
        args: [{
                imports: [CommonModule],
                declarations: [
                    DynamicComponent,
                    DynamicDirective,
                    ComponentOutletInjectorDirective,
                    DynamicAttributesDirective,
                ],
                exports: [
                    DynamicComponent,
                    DynamicDirective,
                    ComponentOutletInjectorDirective,
                    DynamicAttributesDirective,
                ]
            }]
    }], function () { return []; }, null); })();
    return DynamicModule;
}());
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
export { DynamicModule, DynamicDirective, DynamicComponent, DynamicAttributesDirective, COMPONENT_INJECTOR as ɵa, ComponentOutletInjectorDirective as ɵb };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctZHluYW1pYy1jb21wb25lbnQuZXM1LmpzIiwic291cmNlcyI6WyJuZy1keW5hbWljLWNvbXBvbmVudC5lczUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O2tDQUFPO0FBQ1A7QUFDQSxLQU1FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBTTtBQUNOO0FBQ0EsS0FNRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQU07QUFDTjtBQUNBLEtBTUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQU07QUFDTjtBQUNBLEtBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztnREFBTTtBQUNOO0FBQ0EsS0FpQkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGlvblRva2VuLCBEaXJlY3RpdmUsIEhvc3QsIEluamVjdCwgSW5qZWN0b3IsIElucHV0LCBLZXlWYWx1ZURpZmZlcnMsIE9wdGlvbmFsLCBSZW5kZXJlcjIsIENvbXBvbmVudCwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgVmlld0NvbnRhaW5lclJlZiwgU2ltcGxlQ2hhbmdlLCBBTkFMWVpFX0ZPUl9FTlRSWV9DT01QT05FTlRTLCBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTmdDb21wb25lbnRPdXRsZXQsIENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgYWRkZWQgYnkgdHNpY2tsZVxuICogQHN1cHByZXNzIHtjaGVja1R5cGVzfSBjaGVja2VkIGJ5IHRzY1xuICovXG52YXIgLyoqIEB0eXBlIHs/fSAqLyBDT01QT05FTlRfSU5KRUNUT1IgPSBuZXcgSW5qZWN0aW9uVG9rZW4oJ0NvbXBvbmVudEluamVjdG9yJyk7XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgYWRkZWQgYnkgdHNpY2tsZVxuICogQHN1cHByZXNzIHtjaGVja1R5cGVzfSBjaGVja2VkIGJ5IHRzY1xuICovXG52YXIgQ29tcG9uZW50T3V0bGV0SW5qZWN0b3JEaXJlY3RpdmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBjb21wb25lbnRPdXRsZXRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDb21wb25lbnRPdXRsZXRJbmplY3RvckRpcmVjdGl2ZShjb21wb25lbnRPdXRsZXQpIHtcbiAgICAgICAgdGhpcy5jb21wb25lbnRPdXRsZXQgPSBjb21wb25lbnRPdXRsZXQ7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb21wb25lbnRPdXRsZXRJbmplY3RvckRpcmVjdGl2ZS5wcm90b3R5cGUsIFwiY29tcG9uZW50UmVmXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAoKHRoaXMuY29tcG9uZW50T3V0bGV0KSkuX2NvbXBvbmVudFJlZjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIENvbXBvbmVudE91dGxldEluamVjdG9yRGlyZWN0aXZlO1xufSgpKTtcbkNvbXBvbmVudE91dGxldEluamVjdG9yRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdbbmdDb21wb25lbnRPdXRsZXRdJyxcbiAgICAgICAgICAgICAgICBleHBvcnRBczogJ25kY0NvbXBvbmVudE91dGxldEluamVjdG9yJyxcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuQ29tcG9uZW50T3V0bGV0SW5qZWN0b3JEaXJlY3RpdmUuY3RvclBhcmFtZXRlcnMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBbXG4gICAgeyB0eXBlOiBOZ0NvbXBvbmVudE91dGxldCwgZGVjb3JhdG9yczogW3sgdHlwZTogSG9zdCB9LF0gfSxcbl07IH07XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgYWRkZWQgYnkgdHNpY2tsZVxuICogQHN1cHByZXNzIHtjaGVja1R5cGVzfSBjaGVja2VkIGJ5IHRzY1xuICovXG52YXIgRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSByZW5kZXJlclxuICAgICAqIEBwYXJhbSB7P30gZGlmZmVyc1xuICAgICAqIEBwYXJhbSB7P30gaW5qZWN0b3JcbiAgICAgKiBAcGFyYW0gez99IGNvbXBvbmVudEluamVjdG9yVHlwZVxuICAgICAqIEBwYXJhbSB7P30gY29tcG9uZW50T3V0bGV0SW5qZWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBEeW5hbWljQXR0cmlidXRlc0RpcmVjdGl2ZShyZW5kZXJlciwgZGlmZmVycywgaW5qZWN0b3IsIGNvbXBvbmVudEluamVjdG9yVHlwZSwgY29tcG9uZW50T3V0bGV0SW5qZWN0b3IpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLmRpZmZlcnMgPSBkaWZmZXJzO1xuICAgICAgICB0aGlzLmluamVjdG9yID0gaW5qZWN0b3I7XG4gICAgICAgIHRoaXMuY29tcG9uZW50SW5qZWN0b3JUeXBlID0gY29tcG9uZW50SW5qZWN0b3JUeXBlO1xuICAgICAgICB0aGlzLmNvbXBvbmVudE91dGxldEluamVjdG9yID0gY29tcG9uZW50T3V0bGV0SW5qZWN0b3I7XG4gICAgICAgIHRoaXMuX2F0dHJzRGlmZmVyID0gdGhpcy5kaWZmZXJzLmZpbmQoe30pLmNyZWF0ZSgpO1xuICAgICAgICB0aGlzLl9jb21wb25lbnRJbmplY3RvciA9IHRoaXMuaW5qZWN0b3IuZ2V0KHRoaXMuY29tcG9uZW50SW5qZWN0b3JUeXBlLCBudWxsKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KER5bmFtaWNBdHRyaWJ1dGVzRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJfYXR0cmlidXRlc1wiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMubmRjRHluYW1pY0F0dHJpYnV0ZXMgfHwgdGhpcy5uZ0NvbXBvbmVudE91dGxldE5kY0R5bmFtaWNBdHRyaWJ1dGVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KER5bmFtaWNBdHRyaWJ1dGVzRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJfY29tcEluamVjdG9yXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudE91dGxldEluamVjdG9yIHx8IHRoaXMuX2NvbXBvbmVudEluamVjdG9yO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUucHJvdG90eXBlLCBcIl9uYXRpdmVFbGVtZW50XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb21wSW5qZWN0b3IuY29tcG9uZW50UmVmLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEeW5hbWljQXR0cmlidXRlc0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiX2NvbXBUeXBlXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb21wSW5qZWN0b3IuY29tcG9uZW50UmVmLmNvbXBvbmVudFR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEeW5hbWljQXR0cmlidXRlc0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiX2lzQ29tcENoYW5nZWRcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7P31cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RDb21wVHlwZSAhPT0gdGhpcy5fY29tcFR5cGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0Q29tcFR5cGUgPSB0aGlzLl9jb21wVHlwZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljQXR0cmlidXRlc0RpcmVjdGl2ZS5wcm90b3R5cGUubmdEb0NoZWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBpc0NvbXBDaGFuZ2VkID0gdGhpcy5faXNDb21wQ2hhbmdlZDtcbiAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gY2hhbmdlcyA9IHRoaXMuX2F0dHJzRGlmZmVyLmRpZmYodGhpcy5fYXR0cmlidXRlcyk7XG4gICAgICAgIGlmIChjaGFuZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLl9sYXN0QXR0ckFjdGlvbnMgPSB0aGlzLl9jaGFuZ2VzVG9BdHRyQWN0aW9ucyhjaGFuZ2VzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhbmdlcyB8fCAoaXNDb21wQ2hhbmdlZCAmJiB0aGlzLl9sYXN0QXR0ckFjdGlvbnMpKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVBdHRyaWJ1dGVzKHRoaXMuX2xhc3RBdHRyQWN0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gbmFtZVxuICAgICAqIEBwYXJhbSB7P30gdmFsdWVcbiAgICAgKiBAcGFyYW0gez89fSBuYW1lc3BhY2VcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNBdHRyaWJ1dGVzRGlyZWN0aXZlLnByb3RvdHlwZS5zZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIG5hbWVzcGFjZSkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZSh0aGlzLl9uYXRpdmVFbGVtZW50LCBuYW1lLCB2YWx1ZSwgbmFtZXNwYWNlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gbmFtZVxuICAgICAqIEBwYXJhbSB7Pz19IG5hbWVzcGFjZVxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUucHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lLCBuYW1lc3BhY2UpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVBdHRyaWJ1dGUodGhpcy5fbmF0aXZlRWxlbWVudCwgbmFtZSwgbmFtZXNwYWNlKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gYWN0aW9uc1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUucHJvdG90eXBlLl91cGRhdGVBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKGFjdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgT2JqZWN0LmtleXMoYWN0aW9ucy5zZXQpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gX3RoaXMuc2V0QXR0cmlidXRlKGtleSwgYWN0aW9ucy5zZXRba2V5XSk7IH0pO1xuICAgICAgICBhY3Rpb25zLnJlbW92ZS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIF90aGlzLnJlbW92ZUF0dHJpYnV0ZShrZXkpOyB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gY2hhbmdlc1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUucHJvdG90eXBlLl9jaGFuZ2VzVG9BdHRyQWN0aW9ucyA9IGZ1bmN0aW9uIChjaGFuZ2VzKSB7XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGF0dHJBY3Rpb25zID0ge1xuICAgICAgICAgICAgc2V0OiB7fSxcbiAgICAgICAgICAgIHJlbW92ZTogW10sXG4gICAgICAgIH07XG4gICAgICAgIGNoYW5nZXMuZm9yRWFjaEFkZGVkSXRlbShmdW5jdGlvbiAocikgeyByZXR1cm4gKGF0dHJBY3Rpb25zLnNldFtyLmtleV0gPSByLmN1cnJlbnRWYWx1ZSk7IH0pO1xuICAgICAgICBjaGFuZ2VzLmZvckVhY2hDaGFuZ2VkSXRlbShmdW5jdGlvbiAocikgeyByZXR1cm4gKGF0dHJBY3Rpb25zLnNldFtyLmtleV0gPSByLmN1cnJlbnRWYWx1ZSk7IH0pO1xuICAgICAgICBjaGFuZ2VzLmZvckVhY2hSZW1vdmVkSXRlbShmdW5jdGlvbiAocikgeyByZXR1cm4gYXR0ckFjdGlvbnMucmVtb3ZlLnB1c2goci5rZXkpOyB9KTtcbiAgICAgICAgcmV0dXJuIGF0dHJBY3Rpb25zO1xuICAgIH07XG4gICAgcmV0dXJuIER5bmFtaWNBdHRyaWJ1dGVzRGlyZWN0aXZlO1xufSgpKTtcbkR5bmFtaWNBdHRyaWJ1dGVzRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdbbmRjRHluYW1pY0F0dHJpYnV0ZXNdLFtuZ0NvbXBvbmVudE91dGxldE5kY0R5bmFtaWNBdHRyaWJ1dGVzXScsXG4gICAgICAgICAgICAgICAgZXhwb3J0QXM6ICduZGNEeW5hbWljQXR0cmlidXRlcycsXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkR5bmFtaWNBdHRyaWJ1dGVzRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gW1xuICAgIHsgdHlwZTogUmVuZGVyZXIyLCB9LFxuICAgIHsgdHlwZTogS2V5VmFsdWVEaWZmZXJzLCB9LFxuICAgIHsgdHlwZTogSW5qZWN0b3IsIH0sXG4gICAgeyB0eXBlOiB1bmRlZmluZWQsIGRlY29yYXRvcnM6IFt7IHR5cGU6IEluamVjdCwgYXJnczogW0NPTVBPTkVOVF9JTkpFQ1RPUixdIH0sXSB9LFxuICAgIHsgdHlwZTogQ29tcG9uZW50T3V0bGV0SW5qZWN0b3JEaXJlY3RpdmUsIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH0sIHsgdHlwZTogSG9zdCB9LF0gfSxcbl07IH07XG5EeW5hbWljQXR0cmlidXRlc0RpcmVjdGl2ZS5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBcIm5kY0R5bmFtaWNBdHRyaWJ1dGVzXCI6IFt7IHR5cGU6IElucHV0IH0sXSxcbiAgICBcIm5nQ29tcG9uZW50T3V0bGV0TmRjRHluYW1pY0F0dHJpYnV0ZXNcIjogW3sgdHlwZTogSW5wdXQgfSxdLFxufTtcbi8qKlxuICogQGZpbGVvdmVydmlldyBhZGRlZCBieSB0c2lja2xlXG4gKiBAc3VwcHJlc3Mge2NoZWNrVHlwZXN9IGNoZWNrZWQgYnkgdHNjXG4gKi9cbnZhciBEeW5hbWljQ29tcG9uZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gX3ZjclxuICAgICAqIEBwYXJhbSB7P30gX2NmclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIER5bmFtaWNDb21wb25lbnQoX3ZjciwgX2Nmcikge1xuICAgICAgICB0aGlzLl92Y3IgPSBfdmNyO1xuICAgICAgICB0aGlzLl9jZnIgPSBfY2ZyO1xuICAgICAgICB0aGlzLm5kY0R5bmFtaWNDcmVhdGVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGNoYW5nZXNcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNDb21wb25lbnQucHJvdG90eXBlLm5nT25DaGFuZ2VzID0gZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICAgICAgaWYgKGNoYW5nZXNbJ25kY0R5bmFtaWNDb21wb25lbnQnXSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVEeW5hbWljQ29tcG9uZW50KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0NvbXBvbmVudC5wcm90b3R5cGUuY3JlYXRlRHluYW1pY0NvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdmNyLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuY29tcG9uZW50UmVmID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMubmRjRHluYW1pY0NvbXBvbmVudCkge1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRSZWYgPSB0aGlzLl92Y3IuY3JlYXRlQ29tcG9uZW50KHRoaXMuX2Nmci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeSh0aGlzLm5kY0R5bmFtaWNDb21wb25lbnQpLCAwLCB0aGlzLl9yZXNvbHZlSW5qZWN0b3IoKSwgdGhpcy5uZGNEeW5hbWljQ29udGVudCk7XG4gICAgICAgICAgICB0aGlzLm5kY0R5bmFtaWNDcmVhdGVkLmVtaXQodGhpcy5jb21wb25lbnRSZWYpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNDb21wb25lbnQucHJvdG90eXBlLl9yZXNvbHZlSW5qZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGluamVjdG9yID0gdGhpcy5uZGNEeW5hbWljSW5qZWN0b3IgfHwgdGhpcy5fdmNyLnBhcmVudEluamVjdG9yO1xuICAgICAgICBpZiAodGhpcy5uZGNEeW5hbWljUHJvdmlkZXJzKSB7XG4gICAgICAgICAgICBpbmplY3RvciA9IEluamVjdG9yLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiB0aGlzLm5kY0R5bmFtaWNQcm92aWRlcnMsXG4gICAgICAgICAgICAgICAgcGFyZW50OiBpbmplY3RvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmplY3RvcjtcbiAgICB9O1xuICAgIHJldHVybiBEeW5hbWljQ29tcG9uZW50O1xufSgpKTtcbkR5bmFtaWNDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ25kYy1keW5hbWljJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJydcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuRHluYW1pY0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFtcbiAgICB7IHR5cGU6IFZpZXdDb250YWluZXJSZWYsIH0sXG4gICAgeyB0eXBlOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIH0sXG5dOyB9O1xuRHluYW1pY0NvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBcIm5kY0R5bmFtaWNDb21wb25lbnRcIjogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgIFwibmRjRHluYW1pY0luamVjdG9yXCI6IFt7IHR5cGU6IElucHV0IH0sXSxcbiAgICBcIm5kY0R5bmFtaWNQcm92aWRlcnNcIjogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgIFwibmRjRHluYW1pY0NvbnRlbnRcIjogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgIFwibmRjRHluYW1pY0NyZWF0ZWRcIjogW3sgdHlwZTogT3V0cHV0IH0sXSxcbn07XG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgYWRkZWQgYnkgdHNpY2tsZVxuICogQHN1cHByZXNzIHtjaGVja1R5cGVzfSBjaGVja2VkIGJ5IHRzY1xuICovXG4vKipcbiAqIEBwYXJhbSB7P30gdmFsXG4gKiBAcmV0dXJuIHs/fVxuICovXG5mdW5jdGlvbiBjcmVhdGVOZXdDaGFuZ2UodmFsKSB7XG4gICAgcmV0dXJuIG5ldyBTaW1wbGVDaGFuZ2UodW5kZWZpbmVkLCB2YWwsIHRydWUpO1xufVxuLyoqXG4gKiBAcGFyYW0gez99IHJlY29yZFxuICogQHBhcmFtIHs/PX0gaXNGaXJzdENoYW5nZVxuICogQHJldHVybiB7P31cbiAqL1xuZnVuY3Rpb24gcmVjb3JkVG9DaGFuZ2UocmVjb3JkLCBpc0ZpcnN0Q2hhbmdlKSB7XG4gICAgaWYgKGlzRmlyc3RDaGFuZ2UgPT09IHZvaWQgMCkgeyBpc0ZpcnN0Q2hhbmdlID0gZmFsc2U7IH1cbiAgICByZXR1cm4gaXNGaXJzdENoYW5nZVxuICAgICAgICA/IGNyZWF0ZU5ld0NoYW5nZShyZWNvcmQuY3VycmVudFZhbHVlKVxuICAgICAgICA6IG5ldyBTaW1wbGVDaGFuZ2UocmVjb3JkLnByZXZpb3VzVmFsdWUsIHJlY29yZC5jdXJyZW50VmFsdWUsIGZhbHNlKTtcbn1cbi8qKlxuICogQHBhcmFtIHs/fSBpc0ZpcnN0Q2hhbmdlc1xuICogQHBhcmFtIHs/fSBzZXR0ZXJcbiAqIEByZXR1cm4gez99XG4gKi9cbmZ1bmN0aW9uIHNldENoYW5nZUZyb21SZWNvcmQoaXNGaXJzdENoYW5nZXMsIHNldHRlcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAocmVjb3JkKSB7IHJldHVybiBzZXR0ZXIocmVjb3JkLCByZWNvcmRUb0NoYW5nZShyZWNvcmQsIGlzRmlyc3RDaGFuZ2VzKSk7IH07XG59XG4vKipcbiAqIEBwYXJhbSB7P30gaXNGaXJzdENoYW5nZXNcbiAqIEByZXR1cm4gez99XG4gKi9cbmZ1bmN0aW9uIGdldENoYW5nZXNSZWNvcmRzKGlzRmlyc3RDaGFuZ2VzKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjaGFuZ2VzKSB7IHJldHVybiBzZXRDaGFuZ2VGcm9tUmVjb3JkKGlzRmlyc3RDaGFuZ2VzLCBmdW5jdGlvbiAocmVjb3JkLCBjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZXNbcmVjb3JkLmtleV0gPSBjaGFuZ2U7IH0pOyB9O1xufVxuLyoqXG4gKiBAcGFyYW0gez99IGlzRmlyc3RDaGFuZ2VzXG4gKiBAcmV0dXJuIHs/fVxuICovXG5mdW5jdGlvbiBnZXROZXdDaGFuZ2VzUmVjb3Jkcyhpc0ZpcnN0Q2hhbmdlcykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoY2hhbmdlcykgeyByZXR1cm4gc2V0Q2hhbmdlRnJvbVJlY29yZChpc0ZpcnN0Q2hhbmdlcywgZnVuY3Rpb24gKHJlY29yZCwgY2hhbmdlKSB7XG4gICAgICAgIGlmICghY2hhbmdlc1tyZWNvcmQua2V5XSkge1xuICAgICAgICAgICAgY2hhbmdlc1tyZWNvcmQua2V5XSA9IGNoYW5nZTtcbiAgICAgICAgfVxuICAgIH0pOyB9O1xufVxudmFyIC8qKiBAdHlwZSB7P30gKi8gZGVmYXVsdE9wdHMgPSB7XG4gICAgaXNGaXJzdENoYW5nZXM6IGZhbHNlLFxuICAgIG9ubHlOZXdDaGFuZ2VzOiBmYWxzZSxcbn07XG4vKipcbiAqIEBwYXJhbSB7Pz19IG9wdHNcbiAqIEByZXR1cm4gez99XG4gKi9cbmZ1bmN0aW9uIGNoYW5nZXNGcm9tUmVjb3JkKG9wdHMpIHtcbiAgICBpZiAob3B0cyA9PT0gdm9pZCAwKSB7IG9wdHMgPSBkZWZhdWx0T3B0czsgfVxuICAgIHJldHVybiBvcHRzLm9ubHlOZXdDaGFuZ2VzXG4gICAgICAgID8gZ2V0TmV3Q2hhbmdlc1JlY29yZHMob3B0cy5pc0ZpcnN0Q2hhbmdlcylcbiAgICAgICAgOiBnZXRDaGFuZ2VzUmVjb3JkcyhvcHRzLmlzRmlyc3RDaGFuZ2VzKTtcbn1cbi8qKlxuICogQGZpbGVvdmVydmlldyBhZGRlZCBieSB0c2lja2xlXG4gKiBAc3VwcHJlc3Mge2NoZWNrVHlwZXN9IGNoZWNrZWQgYnkgdHNjXG4gKi9cbnZhciAvKiogQHR5cGUgez99ICovIHJlY29yZFRvQ2hhbmdlcyA9IGNoYW5nZXNGcm9tUmVjb3JkKHsgaXNGaXJzdENoYW5nZXM6IHRydWUgfSk7XG52YXIgLyoqIEB0eXBlIHs/fSAqLyByZWNvcmRUb05ld0NoYW5nZXMgPSBjaGFuZ2VzRnJvbVJlY29yZCh7IG9ubHlOZXdDaGFuZ2VzOiB0cnVlIH0pO1xudmFyIER5bmFtaWNEaXJlY3RpdmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBfZGlmZmVyc1xuICAgICAqIEBwYXJhbSB7P30gX2luamVjdG9yXG4gICAgICogQHBhcmFtIHs/fSBfY2ZyXG4gICAgICogQHBhcmFtIHs/fSBfY29tcG9uZW50SW5qZWN0b3JUeXBlXG4gICAgICogQHBhcmFtIHs/fSBfY29tcG9uZW50T3V0bGV0SW5qZWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBEeW5hbWljRGlyZWN0aXZlKF9kaWZmZXJzLCBfaW5qZWN0b3IsIF9jZnIsIF9jb21wb25lbnRJbmplY3RvclR5cGUsIF9jb21wb25lbnRPdXRsZXRJbmplY3Rvcikge1xuICAgICAgICB0aGlzLl9kaWZmZXJzID0gX2RpZmZlcnM7XG4gICAgICAgIHRoaXMuX2luamVjdG9yID0gX2luamVjdG9yO1xuICAgICAgICB0aGlzLl9jZnIgPSBfY2ZyO1xuICAgICAgICB0aGlzLl9jb21wb25lbnRJbmplY3RvclR5cGUgPSBfY29tcG9uZW50SW5qZWN0b3JUeXBlO1xuICAgICAgICB0aGlzLl9jb21wb25lbnRPdXRsZXRJbmplY3RvciA9IF9jb21wb25lbnRPdXRsZXRJbmplY3RvcjtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50SW5qZWN0b3IgPSB0aGlzLl9pbmplY3Rvci5nZXQodGhpcy5fY29tcG9uZW50SW5qZWN0b3JUeXBlLCBudWxsKTtcbiAgICAgICAgdGhpcy5fbGFzdENvbXBvbmVudEluc3QgPSB0aGlzLl9jb21wb25lbnRJbmplY3RvcjtcbiAgICAgICAgdGhpcy5faW5wdXRzRGlmZmVyID0gdGhpcy5fZGlmZmVycy5maW5kKHt9KS5jcmVhdGUoKTtcbiAgICAgICAgdGhpcy5fY29tcEZhY3RvcnkgPSBudWxsO1xuICAgICAgICB0aGlzLl9vdXRwdXRzU2hvdWxkRGlzY29ubmVjdCQgPSBuZXcgU3ViamVjdCgpO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiX2lucHV0c1wiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZGNEeW5hbWljSW5wdXRzIHx8IHRoaXMubmdDb21wb25lbnRPdXRsZXROZGNEeW5hbWljSW5wdXRzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiX291dHB1dHNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7P31cbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmRjRHluYW1pY091dHB1dHMgfHwgdGhpcy5uZ0NvbXBvbmVudE91dGxldE5kY0R5bmFtaWNPdXRwdXRzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiX2NvbXBJbmplY3RvclwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50T3V0bGV0SW5qZWN0b3IgfHwgdGhpcy5fY29tcG9uZW50SW5qZWN0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZSwgXCJfY29tcFJlZlwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29tcEluamVjdG9yLmNvbXBvbmVudFJlZjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KER5bmFtaWNEaXJlY3RpdmUucHJvdG90eXBlLCBcIl9jb21wb25lbnRJbnN0XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb21wUmVmLmluc3RhbmNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUsIFwiX2NvbXBvbmVudEluc3RDaGFuZ2VkXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4gez99XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9sYXN0Q29tcG9uZW50SW5zdCAhPT0gdGhpcy5fY29tcG9uZW50SW5zdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RDb21wb25lbnRJbnN0ID0gdGhpcy5fY29tcG9uZW50SW5zdDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBjaGFuZ2VzXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5uZ09uQ2hhbmdlcyA9IGZ1bmN0aW9uIChjaGFuZ2VzKSB7XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGNvbXBDaGFuZ2VkID0gdGhpcy5fY29tcG9uZW50SW5zdENoYW5nZWQ7XG4gICAgICAgIGlmIChjb21wQ2hhbmdlZCB8fCB0aGlzLl9pbnB1dHNDaGFuZ2VkKGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBpbnB1dHNDaGFuZ2VzID0gdGhpcy5fZ2V0SW5wdXRzQ2hhbmdlcyh0aGlzLl9pbnB1dHMpO1xuICAgICAgICAgICAgaWYgKGlucHV0c0NoYW5nZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVJbnB1dENoYW5nZXMoaW5wdXRzQ2hhbmdlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUlucHV0cyhjb21wQ2hhbmdlZCB8fCAhdGhpcy5fbGFzdElucHV0Q2hhbmdlcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBDaGFuZ2VkIHx8IHRoaXMuX291dHB1dHNDaGFuZ2VkKGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB0aGlzLmJpbmRPdXRwdXRzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUubmdEb0NoZWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fY29tcG9uZW50SW5zdENoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlSW5wdXRzKHRydWUpO1xuICAgICAgICAgICAgdGhpcy5iaW5kT3V0cHV0cygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGlucHV0cyA9IHRoaXMuX2lucHV0cztcbiAgICAgICAgaWYgKCFpbnB1dHMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBpbnB1dHNDaGFuZ2VzID0gdGhpcy5fZ2V0SW5wdXRzQ2hhbmdlcyh0aGlzLl9pbnB1dHMpO1xuICAgICAgICBpZiAoaW5wdXRzQ2hhbmdlcykge1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gaXNOb3RGaXJzdENoYW5nZSA9ICEhdGhpcy5fbGFzdElucHV0Q2hhbmdlcztcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUlucHV0Q2hhbmdlcyhpbnB1dHNDaGFuZ2VzKTtcbiAgICAgICAgICAgIGlmIChpc05vdEZpcnN0Q2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVJbnB1dHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5uZ09uRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGlzY29ubmVjdE91dHB1dHMoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Pz19IGlzRmlyc3RDaGFuZ2VcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNEaXJlY3RpdmUucHJvdG90eXBlLnVwZGF0ZUlucHV0cyA9IGZ1bmN0aW9uIChpc0ZpcnN0Q2hhbmdlKSB7XG4gICAgICAgIGlmIChpc0ZpcnN0Q2hhbmdlID09PSB2b2lkIDApIHsgaXNGaXJzdENoYW5nZSA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChpc0ZpcnN0Q2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVDb21wRmFjdG9yeSgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGNvbXBJbnN0ID0gdGhpcy5fY29tcG9uZW50SW5zdDtcbiAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gaW5wdXRzID0gdGhpcy5faW5wdXRzO1xuICAgICAgICBpZiAoIWlucHV0cyB8fCAhY29tcEluc3QpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpbnB1dHMgPSB0aGlzLl9yZXNvbHZlSW5wdXRzKGlucHV0cyk7XG4gICAgICAgIE9iamVjdC5rZXlzKGlucHV0cykuZm9yRWFjaChmdW5jdGlvbiAocCkgeyByZXR1cm4gKGNvbXBJbnN0W3BdID0gaW5wdXRzW3BdKTsgfSk7XG4gICAgICAgIHRoaXMubm90aWZ5T25JbnB1dENoYW5nZXModGhpcy5fbGFzdElucHV0Q2hhbmdlcywgaXNGaXJzdENoYW5nZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNEaXJlY3RpdmUucHJvdG90eXBlLmJpbmRPdXRwdXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9kaXNjb25uZWN0T3V0cHV0cygpO1xuICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBjb21wSW5zdCA9IHRoaXMuX2NvbXBvbmVudEluc3Q7XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIG91dHB1dHMgPSB0aGlzLl9vdXRwdXRzO1xuICAgICAgICBpZiAoIW91dHB1dHMgfHwgIWNvbXBJbnN0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0cyA9IHRoaXMuX3Jlc29sdmVPdXRwdXRzKG91dHB1dHMpO1xuICAgICAgICBPYmplY3Qua2V5cyhvdXRwdXRzKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gY29tcEluc3RbcF07IH0pXG4gICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAocCkgeyByZXR1cm4gY29tcEluc3RbcF1cbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbChfdGhpcy5fb3V0cHV0c1Nob3VsZERpc2Nvbm5lY3QkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUob3V0cHV0c1twXSk7IH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/PX0gY2hhbmdlc1xuICAgICAqIEBwYXJhbSB7Pz19IGZvcmNlRmlyc3RDaGFuZ2VzXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5ub3RpZnlPbklucHV0Q2hhbmdlcyA9IGZ1bmN0aW9uIChjaGFuZ2VzLCBmb3JjZUZpcnN0Q2hhbmdlcykge1xuICAgICAgICBpZiAoY2hhbmdlcyA9PT0gdm9pZCAwKSB7IGNoYW5nZXMgPSB7fTsgfVxuICAgICAgICAvLyBFeGl0IGVhcmx5IGlmIGNvbXBvbmVudCBub3QgaW50ZXJlc3RlZCB0byByZWNlaXZlIGNoYW5nZXNcbiAgICAgICAgaWYgKCF0aGlzLl9jb21wb25lbnRJbnN0Lm5nT25DaGFuZ2VzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvcmNlRmlyc3RDaGFuZ2VzKSB7XG4gICAgICAgICAgICBjaGFuZ2VzID0gdGhpcy5fY29sbGVjdEZpcnN0Q2hhbmdlcygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbXBvbmVudEluc3QubmdPbkNoYW5nZXMoY2hhbmdlcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNEaXJlY3RpdmUucHJvdG90eXBlLl9kaXNjb25uZWN0T3V0cHV0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fb3V0cHV0c1Nob3VsZERpc2Nvbm5lY3QkLm5leHQoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gaW5wdXRzXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5fZ2V0SW5wdXRzQ2hhbmdlcyA9IGZ1bmN0aW9uIChpbnB1dHMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0c0RpZmZlci5kaWZmKHRoaXMuX2lucHV0cyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IGRpZmZlclxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUuX3VwZGF0ZUlucHV0Q2hhbmdlcyA9IGZ1bmN0aW9uIChkaWZmZXIpIHtcbiAgICAgICAgdGhpcy5fbGFzdElucHV0Q2hhbmdlcyA9IHRoaXMuX2NvbGxlY3RDaGFuZ2VzRnJvbURpZmZlcihkaWZmZXIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5fY29sbGVjdEZpcnN0Q2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gY2hhbmdlcyA9ICh7fSk7XG4gICAgICAgIHZhciAvKiogQHR5cGUgez99ICovIGlucHV0cyA9IHRoaXMuX2lucHV0cztcbiAgICAgICAgT2JqZWN0LmtleXMoaW5wdXRzKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7IHJldHVybiAoY2hhbmdlc1twcm9wXSA9IGNyZWF0ZU5ld0NoYW5nZShpbnB1dHNbcHJvcF0pKTsgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXNvbHZlQ2hhbmdlcyhjaGFuZ2VzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gZGlmZmVyXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5fY29sbGVjdENoYW5nZXNGcm9tRGlmZmVyID0gZnVuY3Rpb24gKGRpZmZlcikge1xuICAgICAgICB2YXIgLyoqIEB0eXBlIHs/fSAqLyBjaGFuZ2VzID0gKHt9KTtcbiAgICAgICAgZGlmZmVyLmZvckVhY2hBZGRlZEl0ZW0ocmVjb3JkVG9DaGFuZ2VzKGNoYW5nZXMpKTtcbiAgICAgICAgZGlmZmVyLmZvckVhY2hJdGVtKHJlY29yZFRvTmV3Q2hhbmdlcyhjaGFuZ2VzKSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXNvbHZlQ2hhbmdlcyhjaGFuZ2VzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gY2hhbmdlc1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUuX2lucHV0c0NoYW5nZWQgPSBmdW5jdGlvbiAoY2hhbmdlcykge1xuICAgICAgICByZXR1cm4gKCduZ0NvbXBvbmVudE91dGxldE5kY0R5bmFtaWNJbnB1dHMnIGluIGNoYW5nZXMgfHxcbiAgICAgICAgICAgICduZGNEeW5hbWljSW5wdXRzJyBpbiBjaGFuZ2VzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gY2hhbmdlc1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUuX291dHB1dHNDaGFuZ2VkID0gZnVuY3Rpb24gKGNoYW5nZXMpIHtcbiAgICAgICAgcmV0dXJuICgnbmdDb21wb25lbnRPdXRsZXROZGNEeW5hbWljT3V0cHV0cycgaW4gY2hhbmdlcyB8fFxuICAgICAgICAgICAgJ25kY0R5bmFtaWNPdXRwdXRzJyBpbiBjaGFuZ2VzKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUuX3Jlc29sdmVDb21wRmFjdG9yeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Nmci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeSh0aGlzLl9jb21wUmVmLmNvbXBvbmVudFR5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBGYWxsYmFjayBpZiBjb21wb25lbnRUeXBlIGRvZXMgbm90IGV4aXN0IChoYXBwZW5zIG9uIE5nQ29tcG9uZW50T3V0bGV0KVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jZnIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkodGhpcy5fY29tcFJlZi5pbnN0YW5jZS5jb25zdHJ1Y3Rvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIEZhY3Rvcnkgbm90IGF2YWlsYWJsZSAtIGJhaWxvdXRcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNEaXJlY3RpdmUucHJvdG90eXBlLl91cGRhdGVDb21wRmFjdG9yeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY29tcEZhY3RvcnkgPSB0aGlzLl9yZXNvbHZlQ29tcEZhY3RvcnkoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gaW5wdXRzXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5fcmVzb2x2ZUlucHV0cyA9IGZ1bmN0aW9uIChpbnB1dHMpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jb21wRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcmVtYXBJTyhpbnB1dHMsIHRoaXMuX2NvbXBGYWN0b3J5LmlucHV0cyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gez99IG91dHB1dHNcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNEaXJlY3RpdmUucHJvdG90eXBlLl9yZXNvbHZlT3V0cHV0cyA9IGZ1bmN0aW9uIChvdXRwdXRzKSB7XG4gICAgICAgIGlmICghdGhpcy5fY29tcEZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybiBvdXRwdXRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9yZW1hcElPKG91dHB1dHMsIHRoaXMuX2NvbXBGYWN0b3J5Lm91dHB1dHMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBjaGFuZ2VzXG4gICAgICogQHJldHVybiB7P31cbiAgICAgKi9cbiAgICBEeW5hbWljRGlyZWN0aXZlLnByb3RvdHlwZS5fcmVzb2x2ZUNoYW5nZXMgPSBmdW5jdGlvbiAoY2hhbmdlcykge1xuICAgICAgICBpZiAoIXRoaXMuX2NvbXBGYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gY2hhbmdlcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcmVtYXBJTyhjaGFuZ2VzLCB0aGlzLl9jb21wRmFjdG9yeS5pbnB1dHMpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBpb1xuICAgICAqIEBwYXJhbSB7P30gbWFwcGluZ1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUuX3JlbWFwSU8gPSBmdW5jdGlvbiAoaW8sIG1hcHBpbmcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gbmV3SU8gPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXMoaW8pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgdmFyIC8qKiBAdHlwZSB7P30gKi8gbmV3S2V5ID0gX3RoaXMuX2ZpbmRQcm9wQnlUcGxJbk1hcHBpbmcoa2V5LCBtYXBwaW5nKSB8fCBrZXk7XG4gICAgICAgICAgICBuZXdJT1tuZXdLZXldID0gaW9ba2V5XTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXdJTztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7P30gdHBsTmFtZVxuICAgICAqIEBwYXJhbSB7P30gbWFwcGluZ1xuICAgICAqIEByZXR1cm4gez99XG4gICAgICovXG4gICAgRHluYW1pY0RpcmVjdGl2ZS5wcm90b3R5cGUuX2ZpbmRQcm9wQnlUcGxJbk1hcHBpbmcgPSBmdW5jdGlvbiAodHBsTmFtZSwgbWFwcGluZykge1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG1hcHBpbmdfMSA9IG1hcHBpbmc7IF9pIDwgbWFwcGluZ18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIG1hcCA9IG1hcHBpbmdfMVtfaV07XG4gICAgICAgICAgICBpZiAobWFwLnRlbXBsYXRlTmFtZSA9PT0gdHBsTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXAucHJvcE5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gRHluYW1pY0RpcmVjdGl2ZTtcbn0oKSk7XG5EeW5hbWljRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdbbmRjRHluYW1pY0lucHV0c10sW25kY0R5bmFtaWNPdXRwdXRzXSxbbmdDb21wb25lbnRPdXRsZXROZGNEeW5hbWljSW5wdXRzXSxbbmdDb21wb25lbnRPdXRsZXROZGNEeW5hbWljT3V0cHV0c10nLFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5EeW5hbWljRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gW1xuICAgIHsgdHlwZTogS2V5VmFsdWVEaWZmZXJzLCB9LFxuICAgIHsgdHlwZTogSW5qZWN0b3IsIH0sXG4gICAgeyB0eXBlOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIH0sXG4gICAgeyB0eXBlOiB1bmRlZmluZWQsIGRlY29yYXRvcnM6IFt7IHR5cGU6IEluamVjdCwgYXJnczogW0NPTVBPTkVOVF9JTkpFQ1RPUixdIH0sXSB9LFxuICAgIHsgdHlwZTogQ29tcG9uZW50T3V0bGV0SW5qZWN0b3JEaXJlY3RpdmUsIGRlY29yYXRvcnM6IFt7IHR5cGU6IEhvc3QgfSwgeyB0eXBlOiBPcHRpb25hbCB9LF0gfSxcbl07IH07XG5EeW5hbWljRGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIFwibmRjRHluYW1pY0lucHV0c1wiOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG4gICAgXCJuZ0NvbXBvbmVudE91dGxldE5kY0R5bmFtaWNJbnB1dHNcIjogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgIFwibmRjRHluYW1pY091dHB1dHNcIjogW3sgdHlwZTogSW5wdXQgfSxdLFxuICAgIFwibmdDb21wb25lbnRPdXRsZXROZGNEeW5hbWljT3V0cHV0c1wiOiBbeyB0eXBlOiBJbnB1dCB9LF0sXG59O1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IGFkZGVkIGJ5IHRzaWNrbGVcbiAqIEBzdXBwcmVzcyB7Y2hlY2tUeXBlc30gY2hlY2tlZCBieSB0c2NcbiAqL1xudmFyIER5bmFtaWNNb2R1bGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRHluYW1pY01vZHVsZSgpIHtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHs/fSBjb21wb25lbnRzXG4gICAgICogQHBhcmFtIHs/PX0gY29tcG9uZW50SW5qZWN0b3JcbiAgICAgKiBAcmV0dXJuIHs/fVxuICAgICAqL1xuICAgIER5bmFtaWNNb2R1bGUud2l0aENvbXBvbmVudHMgPSBmdW5jdGlvbiAoY29tcG9uZW50cywgY29tcG9uZW50SW5qZWN0b3IpIHtcbiAgICAgICAgaWYgKGNvbXBvbmVudEluamVjdG9yID09PSB2b2lkIDApIHsgY29tcG9uZW50SW5qZWN0b3IgPSBEeW5hbWljQ29tcG9uZW50OyB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuZ01vZHVsZTogRHluYW1pY01vZHVsZSxcbiAgICAgICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogQU5BTFlaRV9GT1JfRU5UUllfQ09NUE9ORU5UUyxcbiAgICAgICAgICAgICAgICAgICAgdXNlVmFsdWU6IGNvbXBvbmVudHMsXG4gICAgICAgICAgICAgICAgICAgIG11bHRpOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgeyBwcm92aWRlOiBDT01QT05FTlRfSU5KRUNUT1IsIHVzZVZhbHVlOiBjb21wb25lbnRJbmplY3RvciB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIHJldHVybiBEeW5hbWljTW9kdWxlO1xufSgpKTtcbkR5bmFtaWNNb2R1bGUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IE5nTW9kdWxlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIGltcG9ydHM6IFtDb21tb25Nb2R1bGVdLFxuICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICBEeW5hbWljQ29tcG9uZW50LFxuICAgICAgICAgICAgICAgICAgICBEeW5hbWljRGlyZWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBDb21wb25lbnRPdXRsZXRJbmplY3RvckRpcmVjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUsXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBleHBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIER5bmFtaWNDb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIER5bmFtaWNEaXJlY3RpdmUsXG4gICAgICAgICAgICAgICAgICAgIENvbXBvbmVudE91dGxldEluamVjdG9yRGlyZWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICBEeW5hbWljQXR0cmlidXRlc0RpcmVjdGl2ZSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IGFkZGVkIGJ5IHRzaWNrbGVcbiAqIEBzdXBwcmVzcyB7Y2hlY2tUeXBlc30gY2hlY2tlZCBieSB0c2NcbiAqL1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IGFkZGVkIGJ5IHRzaWNrbGVcbiAqIEBzdXBwcmVzcyB7Y2hlY2tUeXBlc30gY2hlY2tlZCBieSB0c2NcbiAqL1xuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IGFkZGVkIGJ5IHRzaWNrbGVcbiAqIEBzdXBwcmVzcyB7Y2hlY2tUeXBlc30gY2hlY2tlZCBieSB0c2NcbiAqL1xuZXhwb3J0IHsgRHluYW1pY01vZHVsZSwgRHluYW1pY0RpcmVjdGl2ZSwgRHluYW1pY0NvbXBvbmVudCwgRHluYW1pY0F0dHJpYnV0ZXNEaXJlY3RpdmUsIENPTVBPTkVOVF9JTkpFQ1RPUiBhcyDJtWEsIENvbXBvbmVudE91dGxldEluamVjdG9yRGlyZWN0aXZlIGFzIMm1YiB9O1xuIl19